!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=3)}([function(t,e,i){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=function(){function t(e){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.time=0,this.speed=0,this.x0=0,this.y0=0,this.z0=0,this.e0=0,e.split(/\r\n|\n/).forEach(function(t){i.parseLine(t)})}var e,i,r;return e=t,(i=[{key:"parseLine",value:function(t){t.startsWith("G92")?this.g92(t):t.startsWith("G1")?this.g1(t):t.startsWith("; filament used")?this.parseFilamentUsedSlic3r(t):t.startsWith(";   Plastic weight")?this.parseWeight(t):t.startsWith(";   Plastic volume")?this.parseVolume(t):t.startsWith(";   Filament length")?this.parseFilamentLenght(t):t.startsWith(";   Build time")&&this.parseBuildTime(t)}},{key:"parseBuildTime",value:function(t){var e=t.indexOf(":")+1;this.formattedTime=t.substring(e),console.log("calculated time: "+this.time),this.time=0;for(var i=this.getValues(t),n=0;n<i.length;n+=2){var r=parseInt(i[n]),a=i[n+1];"hours"==a||"hour"==a?this.time+=60*r:"minutes"!=a&&"minute"!=a||(this.time+=r)}console.log("simplify time: "+this.time)}},{key:"g1",value:function(t){for(var e=t.split(" "),i=0,n=0,r=0,a=1;a<e.length;a++){var s=e[a][0],o=parseInt(e[a].substring(1));switch(s){case"E":i=o-this.e0;break;case"F":this.speed=o;break;case"X":n=o-this.x0,this.x0=o;break;case"Y":var u=o-this.y0;this.y0=o,r=Math.sqrt(Math.pow(n,2)+Math.pow(u,2));break;case"Z":var l=o-this.z0;this.z0=o,r=l}}if(r=Math.max(r,i),0!=this.speed){var h=r/this.speed;this.time+=h}}},{key:"g92",value:function(t){switch(t.split(" ")[1][0]){case"E":this.e0=0;break;case"X":this.x0=0;break;case"Y":this.y0=0;break;case"Z":this.z0=0}}},{key:"parseFilamentLenght",value:function(t){this.length=this.getValues(t)[0]}},{key:"parseFilamentUsedSlic3r",value:function(t){var e=t.indexOf("=")+1,i=t.substring(e).trim().split(" ");i[0].endsWith("g")?this.weight=i[0].replace("g",""):i[0].endsWith("mm")&&(this.length=i[0].replace("mm",""),this.volume=i[1].replace("(","").replace("cm3)",""))}},{key:"parseVolume",value:function(t){this.volume=this.getValues(t)[0]}},{key:"parseWeight",value:function(t){this.weight=this.getValues(t)[0]}},{key:"getValues",value:function(t){var e=t.indexOf(":")+1;return t.substring(e).trim().split(" ")}}])&&n(e.prototype,i),r&&n(e,r),t}();e.default=r},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.Text=e.Input=e.Print=void 0;var s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";n(this,t),this.name=e,this.weight=0,this.time=0,this.formattedTime="",this.filamentCost=0,this.energyCost=0,this.additionalCost=0,this.failureMargin=0,this.totalCost=0,this.roi=0,this.markup=0,this.sellPrice=0}return a(t,[{key:"add",value:function(t){this.time+=t.time,this.weight+=t.weight,this.filamentCost+=t.filamentCost,this.energyCost+=t.energyCost,this.additionalCost+=t.additionalCost,this.failureMargin+=t.failureMargin,this.totalCost+=t.totalCost,this.roi+=t.roi,this.markup+=t.markup,this.sellPrice+=t.sellPrice}},{key:"render",value:function(){this.fields=[new u("name",this.name),new u("weight",this.toFloat(this.weight)),new u("time",this.formattedTime?this.formattedTime:this.toFloat(this.time,0)),new u("filament_cost",this.toFloat(this.filamentCost)),new u("energy_cost",this.toFloat(this.energyCost)),new u("additional_cost",this.toFloat(this.additionalCost)),new u("total_cost",this.toFloat(this.totalCost)),new u("failure_margin",this.toFloat(this.failureMargin)),new u("roi",this.toFloat(this.roi)),new u("markup",this.toFloat(this.markup)),new u("sell_price",this.toFloat(this.sellPrice))];var t=document.createElement("tr");return t.setAttribute("id",this.name),this.fields.forEach(function(e){return t.appendChild(e.render())}),t}},{key:"toFloat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return parseFloat(""+t).toFixed(e)}}]),t}();e.Print=s;var o=function(){function t(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text",a=arguments.length>3?arguments[3]:void 0;n(this,t),this.name=e,this.value=i,this.type=r,this.step=a}return a(t,[{key:"render",value:function(){var t=document.createElement("input");t.setAttribute("name",this.name),t.setAttribute("value",this.value),t.setAttribute("type",this.type),t.setAttribute("class","form-control"),t.setAttribute("step",this.step);var e=document.createElement("td");return e.appendChild(t),e}}]),t}();e.Input=o;var u=function(){function t(e,i){n(this,t),this.name=e,this.value=i}return a(t,[{key:"render",value:function(){var t=document.createElement("text");t.textContent=this.value;var e=document.createElement("td");return e.appendChild(t),e}}]),t}();e.Text=u;var l=s;e.default=l},function(t,e,i){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.Parameters=void 0;var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.inputs=document.querySelectorAll("#parameters input"),this.values={},this.onChangeListeners=[],this.load(),this.registerOnInputChange()}var e,i,r;return e=t,(i=[{key:"addOnChangeListeners",value:function(t){this.onChangeListeners.push(t)}},{key:"notifyOnChangeListeners",value:function(){this.onChangeListeners.forEach(function(t){return t()})}},{key:"load",value:function(){var t=this;this.inputs.forEach(function(e){var i=localStorage.getItem(e.getAttribute("id"));i&&(e.value=i),t.values[e.getAttribute("id")]=e.value})}},{key:"getValue",value:function(t){return 1*this.values[t]}},{key:"registerOnInputChange",value:function(){var t=this;this.inputs.forEach(function(e){return e.onchange=function(){t.store(),t.notifyOnChangeListeners()}})}},{key:"store",value:function(){var t=this;this.inputs.forEach(function(e){var i=e.getAttribute("id");t.values[i]=e.value,localStorage.setItem(i,e.value)})}}])&&n(e.prototype,i),r&&n(e,r),t}();e.Parameters=r;var a=r;e.default=a},function(t,e,i){"use strict";var n=s(i(2)),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,i):{};n.get||n.set?Object.defineProperty(e,i,n):e[i]=t[i]}return e.default=t,e}(i(1)),a=s(i(0));function s(t){return t&&t.__esModule?t:{default:t}}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}new(function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.parameters=new n.default,this.parameters.addOnChangeListeners(function(){return e.render()}),this.prints=[],this.bindUI(),this.render()}var e,i,s;return e=t,(i=[{key:"bindUI",value:function(){var t=this;this.printsTable=document.getElementById("prints_table"),this.printsTable.style.display="none",this.printsBody=document.getElementById("prints_body"),this.fileInput=document.getElementById("file"),this.fileInput.onchange=function(e){return t.readFiles(e.target.files)}}},{key:"readFiles",value:function(t){var e=this;Object.values(t).forEach(function(t){var i=new FileReader;i.onload=function(){return e.parseGCode(t,i.result)},i.readAsText(t)}),this.fileInput.value=""}},{key:"parseGCode",value:function(t,e){var i=new r.default(t.name),n=new a.default(e);i.weight=n.weight,i.time=n.time,i.formattedTime=n.formattedTime,this.prints.push(i),this.render()}},{key:"render",value:function(){var t=this;if(0!=this.prints.length){this.printsTable.style.display="block",this.printsBody.innerHTML="";var e=new r.default("TOTAL"),i=this.calculateROI();this.prints.forEach(function(n){n.filamentCost=n.weight*t.parameters.getValue("filament_cost")/1e3,n.energyCost=n.time*t.parameters.getValue("power_rating")*t.parameters.getValue("energy_cost")/6e4,n.additionalCost=t.parameters.getValue("additional_cost"),n.totalCost=n.filamentCost+n.energyCost+n.additionalCost,n.failureMargin=n.totalCost*t.parameters.getValue("failure_margin")/100,n.markup=n.totalCost*t.parameters.getValue("markup")/100,n.roi=n.time*i,n.sellPrice=n.totalCost+n.failureMargin+n.roi+n.markup,e.add(n),t.printsBody.appendChild(n.render())}),this.printsBody.appendChild(e.render())}}},{key:"calculateROI",value:function(){return this.parameters.getValue("investment")/this.parameters.getValue("desired_time")/30/this.parameters.getValue("work_hours")/60}}])&&o(e.prototype,i),s&&o(e,s),t}())}]);